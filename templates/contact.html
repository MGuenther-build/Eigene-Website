
<!-- templates/contact.html -->
{% extends "index.html" %}

{% block title %}Kontakt{% endblock %}

{% block content %}
<section id="kontakt" class="contact-form">
    <h2>Kontakt</h2>
    <form id="KontaktID" action="#" method="post">
        <div class="contact-names">
            <div>
                <label for="vorname">Vorname</label>
                <input type="text" id="vorname" name="vorname" required>
            </div>
            <div>
                <label for="nachname">Nachname</label>
                <input type="text" id="nachname" name="nachname" required>
            </div>
        </div>

        <label for="email">E-Mail-Adresse</label>
        <input type="email" id="email" name="email" required>

        <label style="margin-bottom: 0.175em;" for="nachricht">Nachricht</label>
        <div id="zeichenzaehler" style="margin-bottom: 0.75em; font-size: 0.75em;"></div>
        <textarea id="nachricht" style="font-size: 1.1em;" name="nachricht" rows="11" required></textarea>

        <button type="submit" id="sendButtonAnimation">Absenden</button>
    </form>
</section>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("KontaktID");
        const button = document.getElementById("sendButtonAnimation");

        form.addEventListener("submit", function (e) {
            e.preventDefault();
            const formData = new FormData(form);

            fetch("/contact", {
                method: "POST",
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    button.classList.add("sent");
                    button.textContent = "Gesendet";
                    button.disabled = true;
                } else {
                    button.textContent = "Fehler!";
                    button.style.backgroundColor = "rgba(186, 45, 45, 0.85)";
                }
            });
        });

        const textarea = document.getElementById("nachricht");
        textarea.addEventListener("input", function () {
            const isEmpty = textarea.value.trim() === "";
            if (!isEmpty) {
                button.classList.remove("sent");
                button.textContent = "Absenden";
                button.disabled = false;
            }
        });

        window.addEventListener("beforeunload", function () {
            form.reset();
            button.classList.remove("sent");
            button.textContent = "Absenden";
            button.disabled = false;
        });
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const maxZeichen = {{ max_Zeichen }};
        const textarea = document.getElementById("nachricht");
        const counter = document.getElementById("zeichenzaehler");

        function updateCounter() {
            const text = textarea.value;
            const remaining = maxZeichen - text.length;

            if (remaining <= 0) {
                textarea.value = text.substring(0, maxZeichen);
                counter.textContent = "keine Zeichen mehr Ã¼brig";
                counter.style.color = "#ed3030";
            } else {
                counter.textContent = `${remaining} Zeichen verbleibend`;
                if (remaining >= 1 && remaining < 50) {
                    counter.textContent = `noch ${remaining} Zeichen`;
                    counter.style.color = "#d52f2f";
                } else {
                    counter.style.color = "#f6f2f2";
                }
            }
        }
        textarea.addEventListener("input", updateCounter);
        updateCounter();
    });
</script>
{% endblock %}
